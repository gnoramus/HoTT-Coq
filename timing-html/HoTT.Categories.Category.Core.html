<html>
<head>
<title>Core.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Core.v</h1>

<div class="code" title="File: Core.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * Definition of a [PreCategory] *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 1
Time: 0.015s">
<div class="time" style="width: 100%"></div>
<pre>Require Export Overture Basics.Notations.</pre>
</div>
<div class="code" title="File: Core.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Set Universe Polymorphism.</pre>
</div>
<div class="code" title="File: Core.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Set Implicit Arguments.</pre>
</div>
<div class="code" title="File: Core.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Generalizable All Variables.</pre>
</div>
<div class="code" title="File: Core.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Set Asymmetric Patterns.</pre>
</div>
<div class="code" title="File: Core.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Declare Scope morphism_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Declare Scope category_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Declare Scope object_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Delimit Scope morphism_scope with morphism.</pre>
</div>
<div class="code" title="File: Core.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Delimit Scope category_scope with category.</pre>
</div>
<div class="code" title="File: Core.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Delimit Scope object_scope with object.</pre>
</div>
<div class="code" title="File: Core.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope morphism_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Quoting the HoTT Book: *)
(** Definition 9.1.1. A precategory [A] consists of the following.

    (i) A type [A₀] of objects. We write [a : A] for [a : A₀].

    (ii) For each [a, b : A], a set [hom_A(a, b)] of arrows or morphisms.

    (iii) For each [a : A], a morphism [1ₐ : hom_A(a, a)].

    (iv) For each [a, b, c : A], a function

         [hom_A(b, c) → hom_A(a, b) → hom_A(a, c)]

         denoted infix by [g ↦ f ↦ g ∘ f] , or sometimes simply by [g f].

    (v) For each [a, b : A] and [f : hom_A(a, b)], we have [f = 1_b ∘
        f] and [f = f ∘ 1ₐ].

    (vi) For each [a, b, c, d : A] and [f : hom_A(a, b)], [g :
         hom_A(b, c)], [h : hom_A(c,d)], we have [h ∘ (g ∘ f) = (h ∘
         g) ∘ f]. *)
(** In addition to these laws, we ask for a few redundant laws to give
    us more judgmental equalities.  For example, since [(p^)^ ≢ p] for
    paths [p], we ask for the symmetrized version of the associativity
    law, so we can swap them when we take the dual. *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 43
Time: 0.006s">
<div class="time" style="width: 40%"></div>
<pre>Record PreCategory :=
  Build_PreCategory' {
      object :&gt; Type;
      morphism : object -&gt; object -&gt; Type;

      identity : forall x, morphism x x;
      compose : forall s d d',
                  morphism d d'
                  -&gt; morphism s d
                  -&gt; morphism s d'
                              where "f 'o' g" := (compose f g);

      associativity : forall x1 x2 x3 x4
                             (m1 : morphism x1 x2)
                             (m2 : morphism x2 x3)
                             (m3 : morphism x3 x4),
                        (m3 o m2) o m1 = m3 o (m2 o m1);
      (** Ask for the symmetrized version of [associativity], so that [(Cᵒᵖ)ᵒᵖ] and [C] are equal without [Funext] *)
      associativity_sym : forall x1 x2 x3 x4
                                 (m1 : morphism x1 x2)
                                 (m2 : morphism x2 x3)
                                 (m3 : morphism x3 x4),
                            m3 o (m2 o m1) = (m3 o m2) o m1;

      left_identity : forall a b (f : morphism a b), identity b o f = f;
      right_identity : forall a b (f : morphism a b), f o identity a = f;
      (** Ask for the double-identity version so that [InitialTerminalCategory.Functors.from_terminal Cᵒᵖ X] and [(InitialTerminalCategory.Functors.from_terminal C X)ᵒᵖ] are convertible. *)
      identity_identity : forall x, identity x o identity x = identity x;

      trunc_morphism : forall s d, IsHSet (morphism s d)
    }.</pre>
</div>
<div class="code" title="File: Core.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Bind Scope category_scope with PreCategory.</pre>
</div>
<div class="code" title="File: Core.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Bind Scope object_scope with object.</pre>
</div>
<div class="code" title="File: Core.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Bind Scope morphism_scope with morphism.</pre>
</div>
<div class="code" title="File: Core.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We want eta-expanded primitive projections to [simpl] away. *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Arguments object !C%category / : rename.</pre>
</div>
<div class="code" title="File: Core.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments morphism !C%category / s d : rename.</pre>
</div>
<div class="code" title="File: Core.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments identity {!C%category} / x%object : rename.</pre>
</div>
<div class="code" title="File: Core.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments compose {!C%category} / {s d d'}%object (m1 m2)%morphism : rename.</pre>
</div>
<div class="code" title="File: Core.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Infix "o" := compose : morphism_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** Perhaps we should consider making this notation more global. *)
(** Perhaps we should pre-reserve all of the notations. *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Notation "x --&gt; y" := (morphism _ x y) : type_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "1" := (identity _) : morphism_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Define a convenience wrapper for building a precategory without
    specifying the redundant proofs. *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 90
Time: 0.002s">
<div class="time" style="width: 13.333333333333%"></div>
<pre>Definition Build_PreCategory
           object morphism identity compose
           associativity left_identity right_identity
  := @Build_PreCategory'
       object
       morphism
       identity
       compose
       associativity
       (fun _ _ _ _ _ _ _ =&gt; symmetry _ _ (associativity _ _ _ _ _ _ _))
       left_identity
       right_identity
       (fun _ =&gt; left_identity _ _ _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance trunc_morphism.</pre>
</div>
<div class="code" title="File: Core.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** create a hint db for all category theory things *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Create HintDb category discriminated.</pre>
</div>
<div class="code" title="File: Core.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** create a hint db for morphisms in categories *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Create HintDb morphism discriminated.</pre>
</div>
<div class="code" title="File: Core.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

#[export]
Hint Resolve left_identity right_identity associativity : category morphism.</pre>
</div>
<div class="code" title="File: Core.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Rewrite left_identity right_identity : category.</pre>
</div>
<div class="code" title="File: Core.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Rewrite left_identity right_identity : morphism.</pre>
</div>
<div class="code" title="File: Core.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Simple laws about the identity morphism *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section identity_unique.</pre>
</div>
<div class="code" title="File: Core.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable C : PreCategory.</pre>
</div>
<div class="code" title="File: Core.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The identity morphism is unique. *)
 </pre>
</div>
<div class="code" title="File: Core.v
Line: 118
Time: 0.001s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>Lemma identity_unique (id0 id1 : forall x, morphism C x x)
        (id1_left : forall s d (m : morphism C s d), id1 _ o m = m)
        (id0_right : forall s d (m : morphism C s d), m o id0 _ = m)
  : id0 == id1.</pre>
</div>
<div class="code" title="File: Core.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro.</pre>
</div>
<div class="code" title="File: Core.v
Line: 123
Time: 0.001s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
    etransitivity;
      [ symmetry; apply id1_left
      | apply id0_right ].</pre>
</div>
<div class="code" title="File: Core.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Anything equal to the identity acts like it.  This is obvious,
      but useful as a helper lemma for automation. *)
 </pre>
</div>
<div class="code" title="File: Core.v
Line: 131
Time: 0.001s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>Definition concat_left_identity s d (m : morphism C s d) i
  : i = 1 -&gt; i o m = m
    := fun H =&gt; (ap10 (ap _ H) _ @ left_identity _ _ _ m)%path.</pre>
</div>
<div class="code" title="File: Core.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition concat_right_identity s d (m : morphism C s d) i
  : i = 1 -&gt; m o i = m
    := fun H =&gt; (ap _ H @ right_identity _ _ _ m)%path.</pre>
</div>
<div class="code" title="File: Core.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End identity_unique.</pre>
</div>
<div class="code" title="File: Core.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Make a separate module for Notations, which can be exported/imported separately. *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export CategoryCoreNotations.</pre>
</div>
<div class="code" title="File: Core.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Infix "o" := compose : morphism_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Perhaps we should consider making this notation more global. *)
  (** Perhaps we should pre-reserve all of the notations. *)
 </pre>
</div>
<div class="code" title="File: Core.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Notation "x --&gt; y" := (@morphism _ x y) : type_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Local Notation "x --&gt; y" := (morphism _ x y) : type_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Notation "1" := (identity _) : morphism_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End CategoryCoreNotations.</pre>
</div>
<div class="code" title="File: Core.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We have a tactic for trying to run a tactic after associating morphisms either all the way to the left, or all the way to the right *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Tactic Notation "try_associativity_quick" tactic(tac) :=
  first [ rewrite &lt;- ?associativity; tac
        | rewrite -&gt; ?associativity; tac ].</pre>
</div>
<div class="code" title="File: Core.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

