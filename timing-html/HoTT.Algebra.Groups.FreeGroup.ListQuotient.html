<html>
<head>
<title>ListQuotient.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ListQuotient.v</h1>

<div class="code" title="File: ListQuotient.v
Line: 1
Time: 0.048s">
<div class="time" style="width: 35.036496350365%"></div>
<pre>Require Import Basics Types.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 1
Time: 0.087s">
<div class="time" style="width: 63.503649635036%"></div>
<pre>
Require Import Groups.Group.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 2
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
Require Import Truncations.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import HIT.Coeq.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope mc_scope.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope mc_mult_scope.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** In this file we construct the free abelian group on a type [A] as a higher inductive type. This construction is due to Kraus-Altenkirch 2018 arXiv:1805.02069. Their construction is actually more general, but we set truncate it to suit our needs which is the free group as a set. *)

</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Reduction.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context (A : Type).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We define words (with inverses) on A to be lists of marked elements of A *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition Words : Type := list (A + A).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Given a marked element of A we can change its mark *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition change_sign : A + A -&gt; A + A
    := fun x =&gt; match x with
                | inl a =&gt; inr a
                | inr a =&gt; inl a
                end.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We introduce a local notation for [change_sign]. It is only defined in this section however. *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Notation "x ^" := (change_sign x).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Changing sign is an involution *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition change_sign_inv a : a^^ = a.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    by destruct a.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can concatenate words using list concatenation *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition word_concat : Words -&gt; Words -&gt; Words := @app _.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We introduce a local notation for word_concat. *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Infix "@" := word_concat.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition word_concat_w_nil x : x @ nil = x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x; trivial.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    cbn; f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition word_concat_w_ww x y z : x @ (y @ z) = (x @ y) @ z.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    revert x z.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction y; intros x z.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 49
Time: 0.004s">
<div class="time" style="width: 2.9197080291971%"></div>
<pre> f_ap; symmetry.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply word_concat_w_nil.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl; revert z y IHy.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x; trivial.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros z y IHy.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl; f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply IHx, IHy.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 55
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Singleton word *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition word_sing (x : A + A) : Words := (cons x nil).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Notation "[ x ]" := (word_sing x).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We define an inductive family [Red] on [Words] which expresses whether a given word can be reduced to the empty list *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 64
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>Inductive Red : Words -&gt; Type :=
    | red_zero : Red nil
    | red_step (y z : Words) (a : A + A)
      : Red (y @ z) -&gt; Red (y @ [a] @ [a^] @ z).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now we wish to define the free group on A as the following HIT: 

    HIT N(A) : hSet
     | eta : Words -&gt; N(A)
     | tau (x : Words) (a : A + A) (y : Words)
         : eta (x @ [a] @ [a^] @ y) = eta (x @ y).

    Since we cannot write our HITs directly like this (without resorting to private inductive types), we will construct this HIT out of HITs we know. In fact, we can define N(A) as a coequalizer. *)

 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition map1 : Words * (A + A) * Words -&gt; Words.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[x a] y].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x @ [a] @ [a^] @ y).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition map2 : Words * (A + A) * Words -&gt; Words.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[x a] y].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x @ y).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now we can define the underlying type of the free group as the 0-truncated coequalizer of these two maps *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition freegroup_type : Type := Tr 0 (Coeq map1 map2).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This is the point constructor *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 94
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>Definition freegroup_eta : Words -&gt; freegroup_type := tr o coeq.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This is the path constructor *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition freegroup_tau (x : Words) (a : A + A) (y : Words)
    : freegroup_eta (x @ [a] @ [a^] @ y) = freegroup_eta (x @ y).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 99
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
    apply path_Tr, tr.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact ((cglue (x, a, y))).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The group operation *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance sgop_freegroup : SgOp freegroup_type.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 107
Time: 0.034s">
<div class="time" style="width: 24.817518248175%"></div>
<pre>
    strip_truncations.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(*      apply tr. *)
   </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>revert x; snrapply Coeq_rec.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; revert y.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 111
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
      snrapply Coeq_rec.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (freegroup_eta (x @ y)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
      intros [[y a] z]; cbn.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (concat (ap _ _) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (concat (word_concat_w_ww _ _ _) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun t =&gt; t @ _)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (concat (word_concat_w_ww _ _ _) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun t =&gt; t @ _)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (word_concat_w_ww _ _ _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (concat _ (ap _ _^)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      2: apply word_concat_w_ww.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply freegroup_tau.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 124
Time: 0.018s">
<div class="time" style="width: 13.138686131387%"></div>
<pre>
    intros [[c b] d].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 125
Time: 0.056s">
<div class="time" style="width: 40.875912408759%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    revert y.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 127
Time: 0.005s">
<div class="time" style="width: 3.6496350364963%"></div>
<pre>
    snrapply Coeq_ind.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 130
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
      rewrite &lt;- word_concat_w_ww.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 131
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
      rewrite &lt;- (word_concat_w_ww _ _ a).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rapply (freegroup_tau c b (d @ a)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 133
Time: 0.084s">
<div class="time" style="width: 61.313868613139%"></div>
<pre>
    intro; rapply path_ishprop.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 134
Time: 0.024s">
<div class="time" style="width: 17.518248175182%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The unit of the free group is the empty word *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance monunit_freegroup_type : MonUnit freegroup_type.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply freegroup_eta.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact nil.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can change the sign of all the elements in a word and reverse the order. This will be the inversion in the group *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint word_change_sign (x : Words) : Words.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct x as [|x xs].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact nil.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (word_change_sign xs @ [change_sign x]).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Changing the sign changes the order of word concatenation *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition word_change_sign_ww (x y : Words)
    : word_change_sign (x @ y) = word_change_sign y @ word_change_sign x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply word_concat_w_nil.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (concat _ (inverse (word_concat_w_ww _ _ _))).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 160
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
    f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This is also involutive *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma word_change_sign_inv x : word_change_sign (word_change_sign x) = x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: reflexivity.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite word_change_sign_ww.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 170
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
    cbn; f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply change_sign_inv.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Changing the sign gives us left inverses *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma word_concat_Vw x : freegroup_eta (word_change_sign x @ x) = mon_unit.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: reflexivity.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    cbn.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    set (a' := a^).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- (change_sign_inv a).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change a^ with a'.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (freegroup_eta ((word_change_sign x @ [a']) @ ([a'^] @ x)) = mon_unit).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite word_concat_w_ww.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite freegroup_tau.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply IHx.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** And since changing the sign is involutive we get right inverses from left inverses *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma word_concat_wV x : freegroup_eta (x @ word_change_sign x) = mon_unit.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    set (x' := word_change_sign x).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- (word_change_sign_inv x).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (freegroup_eta (word_change_sign x' @ x') = mon_unit).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply word_concat_Vw.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Negation is defined by changing the order of a word that appears in eta. Most of the work here is checking that it is agreeable with the path constructor. *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance negate_freegroup_type : Negate freegroup_type.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 202
Time: 0.009s">
<div class="time" style="width: 6.5693430656934%"></div>
<pre>
    strip_truncations.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    revert x; srapply Coeq_rec.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply freegroup_eta.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (word_change_sign x).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[b a] c].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold map1, map2.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (concat _ (ap _ (inverse _))).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    2: apply word_change_sign_ww.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (concat (ap _ _) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (concat (word_change_sign_ww _ _) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (concat (ap _ (inverse (word_concat_w_ww _ _ _))) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (concat (word_change_sign_ww _ _) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rapply (ap (fun t =&gt; t @ word_change_sign b)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply word_change_sign_ww.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (concat _ (freegroup_tau _ a _)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 220
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
    refine (concat (word_concat_w_ww _ _ _) _); f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 221
Time: 0.003s">
<div class="time" style="width: 2.1897810218978%"></div>
<pre>
    refine (concat (word_concat_w_ww _ _ _) _); f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 222
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
    f_ap; cbn; f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply change_sign_inv.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 224
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now we can start to prove the group laws. Since these are hprops we can ignore what happens with the path constructor. *)

  (** Our operation is associative *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance associative_freegroup_type : Associative sg_op.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y z.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 232
Time: 0.075s">
<div class="time" style="width: 54.744525547445%"></div>
<pre>
    strip_truncations.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 233
Time: 0.005s">
<div class="time" style="width: 3.6496350364963%"></div>
<pre>
    revert x; snrapply Coeq_ind; intro x; [ | apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 234
Time: 0.006s">
<div class="time" style="width: 4.3795620437956%"></div>
<pre>
    revert y; snrapply Coeq_ind; intro y; [ | apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 235
Time: 0.006s">
<div class="time" style="width: 4.3795620437956%"></div>
<pre>
    revert z; snrapply Coeq_ind; intro z; [ | apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 236
Time: 0.011s">
<div class="time" style="width: 8.029197080292%"></div>
<pre>
    cbn; apply ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply word_concat_w_ww.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 238
Time: 0.062s">
<div class="time" style="width: 45.255474452555%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Left identity *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance leftidentity_freegroup_type : LeftIdentity sg_op mon_unit.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 243
Time: 0.014s">
<div class="time" style="width: 10.21897810219%"></div>
<pre>
    rapply Trunc_ind.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 244
Time: 0.005s">
<div class="time" style="width: 3.6496350364963%"></div>
<pre>
    srapply Coeq_ind; intro x; [ | apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 246
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Right identity *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance rightidentity_freegroup_type : RightIdentity sg_op mon_unit.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 251
Time: 0.013s">
<div class="time" style="width: 9.4890510948905%"></div>
<pre>
    rapply Trunc_ind.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 252
Time: 0.005s">
<div class="time" style="width: 3.6496350364963%"></div>
<pre>
    srapply Coeq_ind; intro x; [ | apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 253
Time: 0.026s">
<div class="time" style="width: 18.978102189781%"></div>
<pre>
    apply (ap tr), ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply word_concat_w_nil.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 255
Time: 0.005s">
<div class="time" style="width: 3.6496350364963%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Left inverse *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 259
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance leftinverse_freegroup_type : LeftInverse sg_op negate mon_unit.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 259
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 260
Time: 0.014s">
<div class="time" style="width: 10.21897810219%"></div>
<pre>
    rapply Trunc_ind.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 261
Time: 0.004s">
<div class="time" style="width: 2.9197080291971%"></div>
<pre>
    srapply Coeq_ind; intro x; [ | apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 262
Time: 0.01s">
<div class="time" style="width: 7.2992700729927%"></div>
<pre>
    apply word_concat_Vw.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 263
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Right inverse *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance rightinverse_freegroup_type : RightInverse sg_op negate mon_unit.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 268
Time: 0.014s">
<div class="time" style="width: 10.21897810219%"></div>
<pre>
    rapply Trunc_ind.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 269
Time: 0.004s">
<div class="time" style="width: 2.9197080291971%"></div>
<pre>
    srapply Coeq_ind; intro x; [ | apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 270
Time: 0.008s">
<div class="time" style="width: 5.8394160583942%"></div>
<pre>
    apply word_concat_wV.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 271
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Finally we have defined the free group on [A] *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition FreeGroup : Group.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 276
Time: 0.004s">
<div class="time" style="width: 2.9197080291971%"></div>
<pre>
    snrapply (Build_Group freegroup_type); repeat split; exact _.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 277
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition words_rec (G : Group) (s : A -&gt; G) : Words -&gt; G.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x as [|x xs].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact mon_unit.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (_ * IHxs).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct x as [x|x].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact (s x).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (- s x).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma words_rec_pp (G : Group) (s : A -&gt; G)  (x y : Words)
    : words_rec G s (x @ y) = words_rec G s x * words_rec G s y.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 294
Time: 0.003s">
<div class="time" style="width: 2.1897810218978%"></div>
<pre>
    1: symmetry; apply left_identity.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 295
Time: 0.016s">
<div class="time" style="width: 11.678832116788%"></div>
<pre>
    cbn; rewrite &lt;- simple_associativity.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 297
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma words_rec_coh (G : Group) (s : A -&gt; G) (a : A + A) (b c : Words)
    : words_rec G s (map1 (b, a, c)) = words_rec G s (map2 (b, a, c)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold map1, map2.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (concat _ (words_rec_pp G s _ _)^).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 304
Time: 0.003s">
<div class="time" style="width: 2.1897810218978%"></div>
<pre>
    refine (concat (words_rec_pp G s _ _) _); f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 305
Time: 0.003s">
<div class="time" style="width: 2.1897810218978%"></div>
<pre>
    refine (concat _ (right_identity _)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (concat (ap _ (word_concat_w_ww _ _ _)^) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 307
Time: 0.007s">
<div class="time" style="width: 5.1094890510949%"></div>
<pre>
    refine (concat (words_rec_pp G s _ _) _); f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 308
Time: 0.01s">
<div class="time" style="width: 7.2992700729927%"></div>
<pre>
    refine (concat (concat (simple_associativity _ _ _) _) (left_identity mon_unit)).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 309
Time: 0.008s">
<div class="time" style="width: 5.8394160583942%"></div>
<pre>
    destruct a; simpl; f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply right_inverse.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply left_inverse.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 312
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Given a group [G] we can construct a group homomorphism [FreeGroup A -&gt; G] if we have a map [A -&gt; G] *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition FreeGroup_rec (G : Group) (s : A -&gt; G)
    : GroupHomomorphism FreeGroup G.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 317
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snrapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 320
Time: 0.014s">
<div class="time" style="width: 10.21897810219%"></div>
<pre> rapply Trunc_rec.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      srapply Coeq_rec.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply words_rec, s.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [[b a] c].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply words_rec_coh.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 324
Time: 0.13s">
<div class="time" style="width: 94.890510948905%"></div>
<pre>
    intros x y; strip_truncations.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 325
Time: 0.022s">
<div class="time" style="width: 16.058394160584%"></div>
<pre>
    revert x; snrapply Coeq_ind; hnf; intro x; [ | apply path_ishprop ].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 326
Time: 0.022s">
<div class="time" style="width: 16.058394160584%"></div>
<pre>
    revert y; snrapply Coeq_ind; hnf; intro y; [ | apply path_ishprop ].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 327
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply words_rec_pp.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 329
Time: 0.064s">
<div class="time" style="width: 46.715328467153%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now we need to prove that the free group satisifes the unviersal property of the free group. *)
  (** TODO: remove funext from here and universal property of free group *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 334
Time: 0.002s">
<div class="time" style="width: 1.4598540145985%"></div>
<pre>Global Instance isfreegroupon_freegroup `{Funext}
    : IsFreeGroupOn A FreeGroup (freegroup_eta o word_sing o inl).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros G f.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snrapply Build_Contr.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> srefine (_;_); simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply FreeGroup_rec, f.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 340
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
      intro x; simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 341
Time: 0.003s">
<div class="time" style="width: 2.1897810218978%"></div>
<pre>
      apply right_identity.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 342
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
    intros [g h].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 343
Time: 0.034s">
<div class="time" style="width: 24.817518248175%"></div>
<pre>
    nrapply path_sigma_hprop; [ exact _ |].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path_grouphomomorphism.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 346
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- (path_forall _ _ h).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 348
Time: 0.055s">
<div class="time" style="width: 40.14598540146%"></div>
<pre>
    strip_truncations; revert x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 349
Time: 0.021s">
<div class="time" style="width: 15.328467153285%"></div>
<pre>
    snrapply Coeq_ind; intro x; [|apply path_ishprop].</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    hnf; symmetry.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 352
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
    1: apply (grp_homo_unit g).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (concat (grp_homo_op g (freegroup_eta [a]) (freegroup_eta x)) _).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 354
Time: 0.001s">
<div class="time" style="width: 0.72992700729927%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 355
Time: 0.007s">
<div class="time" style="width: 5.1094890510949%"></div>
<pre>
    f_ap.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 356
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct a.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: reflexivity.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (grp_homo_inv g (freegroup_eta [inl a])).</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 359
Time: 0.019s">
<div class="time" style="width: 13.868613138686%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 360
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Typeclass search can already find this but we leave it here as a definition for reference. *)
 </pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isfreegroup_freegrup `{Funext} : IsFreeGroup FreeGroup := _.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 363
Time: 0.137s">
<div class="time" style="width: 100%"></div>
<pre>

End Reduction.</pre>
</div>
<div class="code" title="File: ListQuotient.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

