<html>
<head>
<title>ua_subalgebra.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ua_subalgebra.v</h1>

<div class="code" title="File: ua_subalgebra.v
Line: 1
Time: 0.132s">
<div class="time" style="width: 100%"></div>
<pre>Require Import
  HoTT.Basics
  HoTT.TruncType
  HoTT.HProp
  HoTT.Types
  HoTT.Classes.theory.ua_homomorphism.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Import algebra_notations ne_list.notations.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section closed_under_op.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Funext} {σ} (A : Algebra σ) (P : ∀ s, A s → Type).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Let [α : A s1 → A s2 → ... → A sn → A t] be an algebra
      operation. Then [P] satisfies [ClosedUnderOp α] iff
      for [x1 : A s1], [x2 : A s2], ..., [xn : A sn],

    &lt;&lt;
      P s1 x1 ∧ P s2 x2 ∧ ... ∧ P sn xn
    &gt;&gt;

    implies

    &lt;&lt;
      P t (α x1 x2 ... xn)
    &gt;&gt;
  *)

 </pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 28
Time: 0.002s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Fixpoint ClosedUnderOp {w : SymbolType σ} : Operation A w → Type :=
    match w with
    | [:s:] =&gt; P s
    | s ::: w' =&gt; λ (α : A s → Operation A w'),
                    ∀ (x : A s), P s x → ClosedUnderOp (α x)
    end.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 33
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>

  Global Instance trunc_closed_under_op {n} `{∀ s x, IsTrunc n (P s x)}
    {w : SymbolType σ} (α : Operation A w)
    : IsTrunc n (ClosedUnderOp α).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 38
Time: 0.004s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
    induction w; cbn; exact _.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 39
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition IsClosedUnderOps : Type
    := ∀ (u : Symbol σ), ClosedUnderOp u.#A.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance trunc_is_closed_under_ops
    {n} `{∀ s x, IsTrunc n (P s x)}
    : IsTrunc n IsClosedUnderOps.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 48
Time: 0.002s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    apply trunc_forall.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End closed_under_op.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** [P : ∀ s, A s → Type] is a subalgebra predicate if it is closed
    under operations [IsClosedUnderOps A P] and [P s x] is an h-prop. *)

</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section subalgebra_predicate.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context  {σ} (A : Algebra σ) (P : ∀ s, A s → Type).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 56
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>

  Class IsSubalgebraPredicate
    := BuildIsSubalgebraPredicate
    { hprop_subalgebra_predicate : ∀ s x, IsHProp (P s x);
      is_closed_under_ops_subalgebra_predicate : IsClosedUnderOps A P }.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance hprop_is_subalgebra_predicate `{Funext}
    : IsHProp IsSubalgebraPredicate.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply hprop_allpath.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [x1 x2] [y1 y2].</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 67
Time: 0.019s">
<div class="time" style="width: 14.393939393939%"></div>
<pre>
    by destruct (path_ishprop x1 y1), (path_ishprop x2 y2).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 68
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 69
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
End subalgebra_predicate.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Arguments BuildIsSubalgebraPredicate {σ A P hprop_subalgebra_predicate}.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance hprop_subalgebra_predicate.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The next section defines subalgebra. *)

</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 77
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
  Context
    {σ : Signature} (A : Algebra σ)
    (P : ∀ s, A s → Type) `{!IsSubalgebraPredicate A P}.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The subalgebra carriers is the family of subtypes defined by [P]. *)

 </pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition carriers_subalgebra : Carriers σ
    := λ (s : Sort σ), {x | P s x}.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Let [α : A s1 → ... → A sn → A t] be an operation and let [C :
    ClosedUnderOp A P α]. The corresponding subalgebra operation
    [op_subalgebra α C : (A&amp;P) s1 → ... → (A&amp;P) sn → (A&amp;P) t] is
    given by

    &lt;&lt;
      op_subalgebra α C (x1; p1) ... (xn; pn) =
        (α x1 ... xn; C x1 p1 x2 p2 ... xn pn).
    &gt;&gt;
*)

 </pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 98
Time: 0.003s">
<div class="time" style="width: 2.2727272727273%"></div>
<pre>Fixpoint op_subalgebra {w : SymbolType σ}
    : ∀ (α : Operation A w),
      ClosedUnderOp A P α → Operation carriers_subalgebra w
    := match w with
       | [:t:] =&gt; λ α c, (α; c)
       | s ::: w' =&gt; λ α c x, op_subalgebra (α x.1) (c x.1 x.2)
       end.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The subalgebra operations [ops_subalgebra] are defined in terms of
    [op_subalgebra]. *)

 </pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ops_subalgebra (u : Symbol σ)
    : Operation carriers_subalgebra (σ u)
    := op_subalgebra u.#A (is_closed_under_ops_subalgebra_predicate A P u).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 111
Time: 0.002s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition Subalgebra : Algebra σ
    := BuildAlgebra carriers_subalgebra ops_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance trunc_subalgebra {n : trunc_index}
    `{!IsTruncAlgebra n.+1 A}
    : IsTruncAlgebra n.+1 Subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (hprop_subalgebra_predicate A P).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro s.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply @trunc_sigma.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 122
Time: 0.004s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 123
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre> induction n; exact _.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 123
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Module subalgebra_notations.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Notation "A &amp;&amp; P" := (Subalgebra A P) : Algebra_scope.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End subalgebra_notations.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Import subalgebra_notations.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The following section defines the inclusion homomorphism
    [Homomorphism (A&amp;P) A], and some related results. *)

</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section hom_inc_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 137
Time: 0.002s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
  Context
    {σ : Signature} (A : Algebra σ)
    (P : ∀ s, A s → Type) `{!IsSubalgebraPredicate A P}.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition def_inc_subalgebra (s : Sort σ) : (A&amp;&amp;P) s → A s
    := pr1.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 143
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>

  Lemma oppreserving_inc_subalgebra {w : SymbolType σ}
    (α : Operation A w) (C : ClosedUnderOp A P α)
    : OpPreserving def_inc_subalgebra (op_subalgebra A P α C) α.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction w.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply IHw.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 151
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance is_homomorphism_inc_subalgebra
    : IsHomomorphism def_inc_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro u.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply oppreserving_inc_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition hom_inc_subalgebra : Homomorphism (A&amp;&amp;P) A
    := BuildHomomorphism def_inc_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma is_isomorphism_inc_improper_subalgebra
    (improper : ∀ s (x : A s), P s x)
    : IsIsomorphism hom_inc_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro s.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (isequiv_adjointify _ (λ x, (x; improper s x)) _ _).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 170
Time: 0.004s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> by apply path_sigma_hprop.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 171
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
End hom_inc_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The next section provides paths between subalgebras. These paths
    are convenient to have because the implicit type-class argument
    [IsClosedUnderOps] of [Subalgebra] is complicating things. *)

</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section path_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context
    {σ : Signature} (A : Algebra σ)
    (P : ∀ s, A s → Type) {CP : IsSubalgebraPredicate A P}
    (Q : ∀ s, A s → Type) {CQ : IsSubalgebraPredicate A Q}.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 181
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>

  Lemma path_subalgebra `{Funext} (p : P = Q) : A&amp;&amp;P = A&amp;&amp;Q.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 184
Time: 0.003s">
<div class="time" style="width: 2.2727272727273%"></div>
<pre>
    by destruct p, (path_ishprop CP CQ).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 186
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>

  Lemma path_subalgebra_iff `{Univalence} (R : ∀ s x, P s x &lt;-&gt; Q s x)
    : A&amp;&amp;P = A&amp;&amp;Q.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 191
Time: 0.001s">
<div class="time" style="width: 0.75757575757576%"></div>
<pre>
    funext s x.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (@path_universe _ _ _ (fst (R s x))).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 193
Time: 0.003s">
<div class="time" style="width: 2.2727272727273%"></div>
<pre>
    apply (equiv_equiv_iff_hprop _ _ (R s x)).</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End path_subalgebra.</pre>
</div>
<div class="code" title="File: ua_subalgebra.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

