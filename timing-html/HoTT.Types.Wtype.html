<html>
<head>
<title>Wtype.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Wtype.v</h1>

<div class="code" title="File: Wtype.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)
(** * Theorems about W-types (well-founded trees) *)

</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 3
Time: 0.014s">
<div class="time" style="width: 21.875%"></div>
<pre>Require Import HoTT.Basics.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 3
Time: 0.016s">
<div class="time" style="width: 25%"></div>
<pre>
Require Import Types.Forall Types.Sigma Types.Paths Types.Unit.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Generalizable Variables X A B C f g n.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Primitive projections do not work for recursive records; see bug #4648 - https://coq.inria.fr/bugs/show_bug.cgi?id=4648. *)</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Unset Primitive Projections.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 9
Time: 0.001s">
<div class="time" style="width: 1.5625%"></div>
<pre>
Inductive W (A : Type) (B : A -&gt; Type) : Type :=
  sup { w_label : A ; w_arg : B w_label -&gt; W A B }.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Set Primitive Projections.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments w_label {A B} _.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments w_arg {A B} _ _.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Paths *)

</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 18
Time: 0.001s">
<div class="time" style="width: 1.5625%"></div>
<pre>Definition path_wtype {A B} (u v : W A B)
  (pq : (w_label u;w_arg u) = (w_label v;w_arg v) :&gt; {a : _ &amp; B a -&gt; W A B})
: u = v.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 21
Time: 0.004s">
<div class="time" style="width: 6.25%"></div>
<pre>
  destruct u,v; apply (path_sigma_uncurried _ _ _)^-1 in pq.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 22
Time: 0.004s">
<div class="time" style="width: 6.25%"></div>
<pre>
  destruct pq as [p q]; cbn in p; destruct p; cbn in q; destruct q.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact idpath.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 24
Time: 0.004s">
<div class="time" style="width: 6.25%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 25
Time: 0.005s">
<div class="time" style="width: 7.8125%"></div>
<pre>

Definition path_wtype_inv {A B} {u v : W A B} (pq : u = v)
: (w_label u;w_arg u) = (w_label v;w_arg v) :&gt; {a : _ &amp; B a -&gt; W A B}
  := match pq with
       | 1 =&gt; match u with
                | sup _ _ =&gt; 1
              end
     end.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** This lets us identify the path space of a W-type, up to equivalence. *)

</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 36
Time: 0.006s">
<div class="time" style="width: 9.375%"></div>
<pre>Definition eisretr_path_wtype {A B} {z z' : W A B}
: (path_wtype z z') o (@path_wtype_inv _ _ z z') == idmap
  := fun p =&gt; match p as p in (_ = z') return
                    path_wtype z z' (path_wtype_inv p) = p
              with
                | 1 =&gt; match z as z return
                             path_wtype z z (path_wtype_inv 1) = 1
                       with
                         | sup _ _ =&gt; 1
                       end
              end.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 46
Time: 0.003s">
<div class="time" style="width: 4.6875%"></div>
<pre>

Definition eissect_path_wtype {A B} {z z' : W A B}
: (@path_wtype_inv _ _ z z') o  (path_wtype z z') == idmap.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 50
Time: 0.006s">
<div class="time" style="width: 9.375%"></div>
<pre>
  intro r; destruct z, z'; set (pq := (path_sigma_uncurried _ _ _)^-1 r).</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 51
Time: 0.007s">
<div class="time" style="width: 10.9375%"></div>
<pre>
  rewrite (eisretr _ _ : path_sigma_uncurried _ _ _ pq = r)^.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 52
Time: 0.022s">
<div class="time" style="width: 34.375%"></div>
<pre>
  destruct pq as [p q]; cbn in p; destruct p; cbn in q; destruct q.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact idpath.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 54
Time: 0.019s">
<div class="time" style="width: 29.6875%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 55
Time: 0.001s">
<div class="time" style="width: 1.5625%"></div>
<pre>

Global Instance isequiv_path_wtype {A B} {z z' : W A B}
: IsEquiv (path_wtype z z') | 0.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 59
Time: 0.001s">
<div class="time" style="width: 1.5625%"></div>
<pre>
  refine (isequiv_adjointify (path_wtype z z')
                       (@path_wtype_inv _ _ z z')
                       (@eisretr_path_wtype A B z z')
                       (@eissect_path_wtype A B z z')).</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 64
Time: 0.001s">
<div class="time" style="width: 1.5625%"></div>
<pre>

Definition equiv_path_wtype {A B} (z z' : W A B)
  := Build_Equiv _ _ _ (@isequiv_path_wtype A B z z').</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** W-types preserve truncation *)

</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance trunc_wtype `{Funext} `{B : A -&gt; Type}
         `{IsTrunc n.+1 A}
: IsTrunc n.+1 (W A B) | 100.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 73
Time: 0.002s">
<div class="time" style="width: 3.125%"></div>
<pre>
  generalize dependent A; intros A B ac; intros z; induction z as [a w].</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 74
Time: 0.064s">
<div class="time" style="width: 100%"></div>
<pre>
  intro y; destruct y as [a0 w0]; refine (trunc_equiv _ (equiv_path_wtype _ _)).</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 75
Time: 0.001s">
<div class="time" style="width: 1.5625%"></div>
<pre>
  apply (trunc_equiv' {p : a = a0 &amp; forall b, w b = w0 (p # b)}).</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 77
Time: 0.001s">
<div class="time" style="width: 1.5625%"></div>
<pre> transitivity {p : a = a0 &amp; transport (fun a =&gt; B a -&gt; W A B) p w = w0}.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_functor_sigma_id; intro p; induction p.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      by apply equiv_path_forall.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    by rapply (equiv_path_sigma _ (a;w) (a0;w0)).</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 80
Time: 0.004s">
<div class="time" style="width: 6.25%"></div>
<pre>
  apply (@trunc_sigma _ _ _ (ac a a0)); intro p; rapply @trunc_forall.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 81
Time: 0.002s">
<div class="time" style="width: 3.125%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Wtype.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

